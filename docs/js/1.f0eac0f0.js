"use strict";(self["webpackChunkelife_env"]=self["webpackChunkelife_env"]||[]).push([[1,35],{5001:function(e,t,a){a.r(t),a.d(t,{default:function(){return D}});var l=function(){var e=this,t=e._self._c;e._self._setupProxy;return t("div",{staticClass:"options goods-list-form"},[t("h4",{staticClass:"options__title"},[e._v(e._s(e.meta.label))]),t("el-form",{staticClass:"options__form",attrs:{model:e.formdata,rules:e.rules,size:"small","label-position":"top"}},[t("el-form-item",{attrs:{prop:"goodsList",error:e.errorsmap.goodsList,label:"选择商品"}},[t("draggable",e._b({staticClass:"goods-list",attrs:{tag:"div"},on:{input:e.handleItemsChange},model:{value:e.formdata.goodsList,callback:function(t){e.$set(e.formdata,"goodsList",t)},expression:"formdata.goodsList"}},"draggable",e.dragOptions,!1),[e._l(e.formdata.goodsList,(function(a,l){return t("div",{key:a.id,staticClass:"col"},[t("div",{staticClass:"goods",attrs:{title:a.name}},[t("div",{staticClass:"img-wrapper"},[t("img",{staticClass:"goods__img",attrs:{src:a.image,alt:""}})]),t("CloseBtn",{staticClass:"goods__remove",attrs:{size:"16"},on:{click:function(t){return e.removeGoods(l)}}})],1)])})),e.formdata.goodsList.length<30?t("div",{staticClass:"col col--add"},[t("div",{staticClass:"add-goods",on:{click:e.showGoodsSelector}},[t("i",{staticClass:"el-icon-plus"})])]):e._e()],2),t("p",{staticClass:"el-form-item__tips"},[e._v("最多添加 30 个商品，拖动商品可排序")])],1)],1),t("el-form",{staticClass:"options__form",attrs:{model:e.formdata,rules:e.rules,size:"small","label-position":"left","label-width":"80px"}},[t("el-form-item",{attrs:{label:"布局方式"}},[t("div",{staticClass:"flex items-center w-full"},[t("span",{staticClass:"el-form-item__value"},[e._v(e._s(e.layoutDisplay[e.formdata.layout]||""))]),t("el-radio-group",{staticClass:"ml-auto",attrs:{size:"small"},on:{change:function(t){return e.handleChange(t,"layout")}},model:{value:e.formdata.layout,callback:function(t){e.$set(e.formdata,"layout",t)},expression:"formdata.layout"}},[t("el-radio-button",{attrs:{label:"col1"}},[t("svg",{staticClass:"radio-button-icon",attrs:{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"}},[t("path",{attrs:{d:"M947.249 0h-870.4a76.8 76.8 0 0 0-76.8 76.8v716.8a76.8 76.8 0 0 0 76.8 76.8h870.4a76.8 76.8 0 0 0 76.8-76.8V76.8a76.8 76.8 0 0 0-76.8-76.8zm-870.4 51.2h870.4a25.6 25.6 0 0 1 25.6 25.6v716.8a25.6 25.6 0 0 1-25.6 25.6h-870.4a25.6 25.6 0 0 1-25.6-25.6V76.8a25.6 25.6 0 0 1 25.6-25.6zm921.6 921.6a25.6 25.6 0 0 1 4.608 50.79l-4.608.41h-972.8a25.6 25.6 0 0 1-4.608-50.79l4.608-.41h972.8z",fill:"currentColor"}}),t("path",{attrs:{d:"M236.234 367.77a25.6 25.6 0 0 1 31.795-6.4l3.84 2.508 338.79 266.19 112.129-134.452a25.6 25.6 0 0 1 30.105-7.014l4.25 2.406 256 179.2-29.389 41.984-236.697-165.734-112.948 135.526a25.6 25.6 0 0 1-31.692 6.246l-3.79-2.508L259.94 419.584 45.463 681.83 5.834 649.37l230.4-281.6zM768.05 153.6a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8zm0 51.2a51.2 51.2 0 1 1 0 102.4 51.2 51.2 0 0 1 0-102.4z",fill:"currentColor"}})])]),t("el-radio-button",{attrs:{label:"col2"}},[t("svg",{staticClass:"radio-button-icon",attrs:{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"}},[t("path",{attrs:{d:"M384.049 0h-307.2a76.8 76.8 0 0 0-76.8 76.8v716.8a76.8 76.8 0 0 0 76.8 76.8h307.2a76.8 76.8 0 0 0 76.8-76.8V76.8a76.8 76.8 0 0 0-76.8-76.8zm-307.2 51.2h307.2a25.6 25.6 0 0 1 25.6 25.6v716.8a25.6 25.6 0 0 1-25.6 25.6h-307.2a25.6 25.6 0 0 1-25.6-25.6V76.8a25.6 25.6 0 0 1 25.6-25.6zM947.249 0h-307.2a76.8 76.8 0 0 0-76.8 76.8v716.8a76.8 76.8 0 0 0 76.8 76.8h307.2a76.8 76.8 0 0 0 76.8-76.8V76.8a76.8 76.8 0 0 0-76.8-76.8zm-307.2 51.2h307.2a25.6 25.6 0 0 1 25.6 25.6v716.8a25.6 25.6 0 0 1-25.6 25.6h-307.2a25.6 25.6 0 0 1-25.6-25.6V76.8a25.6 25.6 0 0 1 25.6-25.6zm-204.8 921.6a25.6 25.6 0 0 1 4.608 50.79l-4.608.41h-409.6a25.6 25.6 0 0 1-4.608-50.79l4.608-.41h409.6zm563.2 0a25.6 25.6 0 0 1 4.608 50.79l-4.608.41h-409.6a25.6 25.6 0 0 1-4.608-50.79l4.608-.41h409.6z",fill:"currentColor"}})])]),t("el-radio-button",{attrs:{label:"list"}},[t("svg",{staticClass:"radio-button-icon",attrs:{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"}},[t("path",{attrs:{d:"M384 0H76.8A76.8 76.8 0 0 0 0 76.8V384a76.8 76.8 0 0 0 76.8 76.8H384a76.8 76.8 0 0 0 76.8-76.8V76.8A76.8 76.8 0 0 0 384 0zM76.8 51.2H384a25.6 25.6 0 0 1 25.6 25.6V384a25.6 25.6 0 0 1-25.6 25.6H76.8A25.6 25.6 0 0 1 51.2 384V76.8a25.6 25.6 0 0 1 25.6-25.6zm307.2 512H76.8A76.8 76.8 0 0 0 0 640v307.2a76.8 76.8 0 0 0 76.8 76.8H384a76.8 76.8 0 0 0 76.8-76.8V640a76.8 76.8 0 0 0-76.8-76.8zM76.8 614.4H384a25.6 25.6 0 0 1 25.6 25.6v307.2a25.6 25.6 0 0 1-25.6 25.6H76.8a25.6 25.6 0 0 1-25.6-25.6V640a25.6 25.6 0 0 1 25.6-25.6zM998.4 76.8a25.6 25.6 0 0 1 4.608 50.79l-4.608.41H588.8a25.6 25.6 0 0 1-4.608-50.79l4.608-.41h409.6zm0 563.2a25.6 25.6 0 0 1 4.608 50.79l-4.608.41H588.8a25.6 25.6 0 0 1-4.608-50.79l4.608-.41h409.6zm0-307.2a25.6 25.6 0 0 1 4.608 50.79l-4.608.41H588.8a25.6 25.6 0 0 1-4.608-50.79l4.608-.41h409.6zm0 563.2a25.6 25.6 0 0 1 4.608 50.79l-4.608.41H588.8a25.6 25.6 0 0 1-4.608-50.79l4.608-.41h409.6z",fill:"currentColor"}})])])],1)],1)]),t("el-form-item",{attrs:{label:"商品名称"}},[t("div",{staticClass:"flex items-center w-full"},[t("span",{staticClass:"el-form-item__value"},[e._v(e._s(e.formdata.isShowName?"显示":"不显示"))]),t("el-switch",{staticClass:"ml-auto",on:{change:function(t){return e.handleChange(t,"isShowName")}},model:{value:e.formdata.isShowName,callback:function(t){e.$set(e.formdata,"isShowName",t)},expression:"formdata.isShowName"}})],1)]),t("el-form-item",{attrs:{label:"商品描述"}},[t("div",{staticClass:"flex items-center w-full"},[t("span",{staticClass:"el-form-item__value"},[e._v(e._s(e.formdata.isShowDesc?"显示":"不显示"))]),t("el-switch",{staticClass:"ml-auto",on:{change:function(t){return e.handleChange(t,"isShowDesc")}},model:{value:e.formdata.isShowDesc,callback:function(t){e.$set(e.formdata,"isShowDesc",t)},expression:"formdata.isShowDesc"}})],1)]),t("el-form-item",{attrs:{label:"商品价格"}},[t("div",{staticClass:"flex items-center w-full"},[t("span",{staticClass:"el-form-item__value"},[e._v(e._s(e.formdata.isShowPrice?"显示":"不显示"))]),t("el-switch",{staticClass:"ml-auto",on:{change:function(t){return e.handleChange(t,"isShowPrice")}},model:{value:e.formdata.isShowPrice,callback:function(t){e.$set(e.formdata,"isShowPrice",t)},expression:"formdata.isShowPrice"}})],1)])],1),t("GoodsSelect",{attrs:{visible:e.goodsSelectorVisible,selection:e.formdata.goodsList,multiple:""},on:{"update:visible":function(t){e.goodsSelectorVisible=t},confirm:e.onGoodsSelected}})],1)},s=[],i=a(4806),o=a.n(i),n=a(6983),r=a.n(n),c=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"选择商品",visible:e.dialogVisible,width:"800px","destroy-on-close":!0},on:{"update:visible":function(t){e.dialogVisible=t}}},[t("div",{staticClass:"goods-filter"},[t("el-form",{attrs:{inline:"",size:"small"}},[t("el-form-item",{attrs:{label:"商品分类："}},[t("el-cascader",{attrs:{options:e.merProductClassify,props:e.cateProps,clearable:"",size:"small","append-to-body":!1},on:{change:e.search},model:{value:e.searchData.cateId,callback:function(t){e.$set(e.searchData,"cateId",t)},expression:"searchData.cateId"}})],1),t("el-form-item",{attrs:{label:"商品名称："}},[t("el-input",{attrs:{placeholder:"请输入商品名称",size:"small",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search.apply(null,arguments)}},model:{value:e.searchData.keywords,callback:function(t){e.$set(e.searchData,"keywords",t)},expression:"searchData.keywords"}})],1)],1)],1),t("SelectableTable",{staticClass:"records",attrs:{loading:e.loading,records:e.tableData,selection:e.selection,multiple:e.multiple},on:{"selection-change":e.onSelectionChange,choose:e.onChoose}},[t("el-table-column",{attrs:{prop:"id",label:"ID",width:"80"}}),t("el-table-column",{attrs:{label:"商品图",width:"80"},scopedSlots:e._u([{key:"default",fn:function(e){return[t("el-image",{staticStyle:{width:"40px",height:"40px"},attrs:{src:e.row.image,fit:"contain","preview-src-list":[e.row.image]}})]}}])}),t("el-table-column",{attrs:{prop:"name",label:"商品名称","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"text-ellipsis",attrs:{title:a.row.name}},[e._v(e._s(a.row.name))])]}}])}),t("el-table-column",{attrs:{prop:"merchantProductCategoryName",label:"商品分类","min-width":"120"}})],1),t("div",{staticClass:"pagination"},[t("el-pagination",{attrs:{layout:"total, prev, pager, next","page-size":e.pagination.limit,total:e.pagination.total,"current-page":e.pagination.page,"pager-count":5,background:"",small:""},on:{"current-change":e.onPageChange}})],1),e.multiple?t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{size:"small"},on:{click:e.onCancel}},[e._v("取消")]),t("el-button",{attrs:{size:"small",type:"primary"},on:{click:e.onConfirm}},[e._v("确定")])],1):e._e()],1)},d=[],u=function(){var e=this,t=e._self._c;return t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"selectable_table",staticClass:"selectable-table",attrs:{size:"mini",data:e.records,stripe:"",border:!0,"header-cell-style":{background:"#f2f2f2"}},on:{"selection-change":e.onSelectionChange}},[e.multiple?t("el-table-column",{attrs:{type:"selection",width:"55",align:"center",selectable:e.selectable}}):e._e(),e._t("default"),e.multiple?e._e():t("el-table-column",{attrs:{label:"选择",width:"120",align:"center"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.onChoose}},[e._v("选择")])]}}],null,!1,172150980)})],2)},h=[],m={name:"SelectableTable",props:{records:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},multiple:{type:Boolean,default:!1},selection:{type:Array,default:()=>[]},selectable:{type:Function,default:()=>!0},identity:{type:[Function,String],default:"id"}},data(){return{selected:null,timer:void 0}},computed:{keyof(){return"function"===typeof this.identity?this.identity:e=>e[this.identity]}},watch:{records:{handler(){this.$nextTick((()=>{this.updateTableSelection()}))},immediate:!0},selection:{handler(){this.initSelected(),this.updateTableSelection()},immediate:!0}},beforeDestroy(){clearTimeout(this.timer)},methods:{diff(e,t){return o().differenceBy(e,t,this.keyof)},union(e,t){return o().unionBy(e,t,this.keyof)},intersection(e,t){return o().intersectionBy(e,t,this.keyof)},initSelected(){Array.isArray(this.selection)?this.selected=this.selection.slice():this.selected=[]},updateTableSelection(){if(!this.multiple)return;null===this.selected&&this.initSelected();const e=this.selected.reduce(((e,t)=>(e[this.keyof(t)]=!0,e)),{}),t=this.$refs.selectable_table;this.records.slice().forEach((a=>{t.toggleRowSelection(a,!!e[this.keyof(a)])}))},onSelectionChange(e){this.multiple&&(null===this.selected&&this.initSelected(),clearTimeout(this.timer),this.timer=setTimeout((()=>{this.selected=this.union(this.diff(this.selected,this.diff(this.records,e)),e),this.$emit("selection-change",o().cloneDeep(this.selected))}),300))},onChoose(e){this.$emit("choose",o().cloneDeep(e))}}},f=m,p=a(1001),g=(0,p.Z)(f,u,h,!1,null,"7d82faf6",null),b=g.exports,v={components:{SelectableTable:b},props:{visible:{type:Boolean,default:!1},selection:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!1}},data(){return{dialogVisible:!1,selected:[],loading:!1,tableData:[],pagination:{page:1,total:0,limit:6},searchData:{cateId:null,keywords:null,type:"1"},cateProps:{children:"childList",label:"name",value:"id",multiple:!1,emitPath:!1}}},watch:{visible:{handler(e){this.dialogVisible!==e&&(this.dialogVisible=e)},immediate:!0},dialogVisible(e){this.visible!==e&&this.$emit("update:visible",e),e&&this.getList(1)}},created(){this.getList()},methods:{getList(){},onPageChange(e){this.getList(e)},search(){this.getList(1)},onSelectionChange(e){this.selected=e},onCancel(){this.dialogVisible=!1,this.selected=[],this.$emit("cancel")},onConfirm(){this.dialogVisible=!1,this.$emit("confirm",this.selected)},onChoose(e){this.dialogVisible=!1,this.$emit("choose",e),this.$emit("change",e)}}},y=v,C=(0,p.Z)(y,c,d,!1,null,"c95c9f82",null),w=C.exports,_=a(1736),S=a(3721),k=a(6035),z=(0,S.WN)(k,{components:{draggable:r(),GoodsSelect:w,CloseBtn:_.Z},data(){return{goodsSelectorVisible:!1,dragOptions:{sort:!0,animation:150,filter:".col--add"},layoutDisplay:{col1:"每行一个",col2:"每行两个",list:"列表模式"}}},methods:{handleItemsChange(){this.handleChange(o().cloneDeep(this.formdata.goodsList),"goodsList")},showGoodsSelector(){this.goodsSelectorVisible=!0},onGoodsSelected(e){this.formdata.goodsList=e.slice(0,30).map((e=>{const{id:t,name:a,image:l,content:s,price:i}=e;return{id:t,name:a,image:l,content:s,price:i}})),this.handleItemsChange()},removeGoods(e){this.formdata.goodsList.splice(e,1),this.handleItemsChange()}}}),x=z,V=(0,p.Z)(x,l,s,!1,null,"e6482712",null),D=V.exports},6035:function(e,t,a){a.r(t),a.d(t,{getFormdata:function(){return i},getMeta:function(){return n},getProps:function(){return s},getRules:function(){return r},getWatchers:function(){return o}});var l=a(3721);function s(){return{goodsList:{type:Array,default:()=>[]},layout:{type:String,default:"col2"},isShowName:{type:Boolean,default:!0},isShowDesc:{type:Boolean,default:!0},isShowPrice:{type:Boolean,default:!0}}}function i(){const e=(0,l.lN)(s());return e}function o(){const e=(0,l._6)(s());return e}function n(){return{name:"goods-list",label:"商品",cate:"basic",limit:100,data:i()}}function r(){return{goodsList:{type:"array",required:!0,message:"请选择商品"}}}}}]);
//# sourceMappingURL=1.f0eac0f0.js.map